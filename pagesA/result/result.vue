<template>	<view>		<navbar title='查询结果' @lefts=left()></navbar>		<view class="container">			<view class="fixation" v-if="result.length!=0"><!--				<view class="switch">--><!--					<selectSwitch @change="changeSwitch" />--><!--				</view>-->				<view class="box1" v-if="sumdata.length!=0">          <u-scroll-list>            <view v-for="(item,index) in Object.entries(sumdata[0])" class="unit4_box">                <view class="unit4_box_item unit4_box_item1">                  <view class="unit4_box_value">{{Number(item[1]).toFixed(2)}}</view>                </view>                <view class="unit4_box_item">                  <view class="unit4_box_key">{{item[0]}}</view>                </view>            </view>          </u-scroll-list>				</view>      </view>      <view v-if="fhsyj">        <u-button @click="isfhsyj()" type="primary">返回上一级</u-button>      </view>			<view v-if="result.length!=0">				<view v-if="!cut">					<view class="tablebox">            <uni-card>              <view style="height: 500px">                <zb-table                    :columns="column"                    :stripe="true"                    @rowClick="rowClick"                    @toggleRowSelection="toggleRowSelection"                    @toggleAllSelection="toggleAllSelection"                    :border="true"                    :data="columndata"></zb-table>              </view>            </uni-card>					</view>				</view>        <!--    卡片显示-->        <view v-if="cut">          <view class="card">            <view v-for="(item,index) in resultcard" class="box" @click="detail(item,index)">              <view v-for="(items,indexs) in cardlist">                <view v-if="cardlist[indexs].length==1" class="cardlist">                  {{cardlist[indexs]}}:{{item[cardlist[indexs]]}}                </view>                <view v-if="1<cardlist[indexs].length" class="cardlistmore">                  <view v-for="(res,indexkey) of cardlist[indexs]" >                    {{cardlist[indexs][indexkey]}}:{{item[cardlist[indexs][indexkey]]}}                  </view>                </view>              </view>            </view>          </view>        </view>        <!--          分页器-->        <view class="fypage">          <uni-pagination title="" :pageSize="pageSize" show-icon="true" :total="total" :current="page"                          @change="dj()">          </uni-pagination>        </view>			</view>		</view>		<view v-if="result.length==0" class="msj">      <view>        <image src="https://integral-1256268364.cos.ap-chengdu.myqcloud.com/c5b9ec0862a57c4cee9d7373806b93cab8013b3c.jpg"></image>      </view>     <view>未查询到数据</view>    </view>	</view></template><script>import {getchild} from "../../network/api";	import selectSwitch from "@/components/xuan-switch/xuan-switch.vue";	import navbar from '../../components/nav.vue'	export default {		data() {			return {        column:'',        columndata:'',				resultcard: '', //卡片数据				showdata: '', //展示数据				page: '', //当前页				total: '', //数据总量				pageSize: 20, //一页数量				bgColor: '#4f99ff',				bdt: [], //表头				result: null, //查询结果				sumdata: '', //数据汇总				cut: false, //切换展示        cardname:'',//卡片上的名称        creportdata:'',//卡片层级        condition:'',//查询条件        fhsyj:false,//返回上一级        cardlist:[],//卡片列显示数据			};		},		components: {			selectSwitch,			navbar,		},		onLoad(option) {this.condition=JSON.parse(option.condition)			this.bdt = JSON.parse(option.bdt)			this.result = JSON.parse(uni.getStorageSync('result'))if(option.sumdata){  this.sumdata = JSON.parse(option.sumdata)}			this.pagination()			this.showdata = this.result[0]//测试卡片形式显示      if(option.creportcolumns){        this.cut=true        this.creportdata=JSON.parse(option.creportdata)        console.log('卡片',option.creportcolumns.split(';'))        this.cardname=option.creportcolumns.split(';')        //分行显示        // this.cardname[0]=this.cardname[0].concat('-1')        // this.cardname[1]=this.cardname[1].concat('-1')        // this.cardname[2]=this.cardname[2].concat('-2')        if(this.cardname[0].indexOf('-')!='-1'){          console.log('存在分行')          let datalist=[]          this.cardname.forEach(item=>{            //item.split('-')[1]            if(!datalist[item.split('-')[1]]){              let arr=[]              arr.push(item.split('-')[0])              datalist[item.split('-')[1]]=arr            }else {              datalist[item.split('-')[1]].push(item.split('-')[0])            }          })          console.log('存在分行数据',datalist)          this.cardlist=datalist        }else {          console.log('不存在分行')        }        this.resultcard = this.result[0]console.log('kapian',this.resultcard)      }		},		onShow() {      //新table1      let column=[]      this.bdt.forEach((item)=>{        column.push({          name:item.name,          label:item.lable,          width:item.width*2,          align:'center'        })      })      // column[0].fixed=true       //column[0].width=120      // column[1].fixed=true      this.column=column      this.columndata=this.showdata    },		methods: {      isfhsyj(){        this.cut=true        this.fhsyj=!this.fhsyj      },			dj(e) {        console.log(e)				this.showdata = this.result[e.current - 1]        this.columndata=this.showdata        if(this.cut){          this.resultcard = this.result[e.current - 1]        }      },			//点击分页			pagination() {				this.total = this.result.length				let pageCount = Math.ceil(this.total / this.pageSize);				this.total % this.pageSize == 0 ? pageCount : pageCount + 1				let arr = this.result				let size = this.pageSize				const arrNum = Math.ceil(arr.length / size, 10); // Math.ceil()向上取整的方法，用来计算拆分后数组的长度				let index = 0; // 定义初始索引				let resIndex = 0; // 用来保存每次拆分的长度				const result = [];				while (index < arrNum) {					result[index] = arr.slice(Number(resIndex), Number(size) + Number(resIndex));					resIndex += size;					index++;				}				this.result = result			},      rowClick(row,index){        console.log('单项表格数据',row)        let data = JSON.stringify(row)        uni.navigateTo({          url: `../../pagesA/detail/detail?list=${data}`        });      },			//自定义返回			left() {				uni.navigateBack({					delta: 1				});			},			changeSwitch(isSwitch) {				// console.log(isSwitch)				this.cut = !this.cut			},			//显示卡片数据			detail(item, index) {        console.log('卡片跳转',item)          let itemdata = JSON.stringify(item)        let data={          access_token:uni.getStorageSync('access_token'),          fdbh:uni.getStorageSync('fdbh'),          groupid:uni.getStorageSync('groupid'),          index:'0',          djtype:uni.getStorageSync('dqbb').cxbh,          userid:uni.getStorageSync('userid'),          username:uni.getStorageSync('dlmc'),          condition:this.condition,//查询条件          childCondition:[item],//当前选择数据        }        getchild(data).then((res)=>{          console.log('子级数据',res)          if(res.data.length>'0'){            this.fhsyj=true            this.cut=false            this.result=res.data            //表单头处理            let cl=res.columns            let a=[];            cl.forEach((item)=>{              a.push({name:item.title,lable:item.title,width:item.width})            })            this.bdt=a            this.pagination()            this.showdata = this.result[0]            let column=[]            this.bdt.forEach((item)=>{              column.push({                name:item.name,                label:item.lable,                width:item.width*2,                align:'center'              })            })            this.column=column            this.columndata=this.showdata          }        })        }		}	}</script><style lang="scss">	page {		background-color: #E5E5E5;	}	.container {}	.switch {		margin: 20rpx;	}	.card {		display: flex;		justify-content: center;		align-items: center;		flex-direction: column;		.box {			margin: 20rpx 0;			width: 700rpx;			border-radius: 20rpx;			background-color: #ffffff;			font-weight: 400;			.boxunit1 {				padding: 20rpx 20rpx;				display: flex;				justify-content: space-between;				font-size: 40rpx;				border-bottom: 1px #E5E5E5 solid;				.boxunit1_name {					color: #52c8f1;				}			}			.boxunit2 {				font-size: 30rpx;				padding: 10rpx 20rpx;				display: flex;				justify-content: space-between;			}			.boxunit3 {				font-size: 30rpx;				padding: 10rpx 20rpx;				display: flex;			}		}	}	.tablebox {		//margin: 0 20rpx;    margin-top: 30rpx;    //margin-left: 20rpx;	}	.box1 {		margin: 20rpx auto;		background-color: #ffffff;		border-radius: 20rpx;		width: 700rpx;	}	.unit4_box {    margin-top: 30rpx;		display: flex;		flex-direction: column;		//align-items: center;    //justify-content: center;		.unit4_box_item {			font-size: 34rpx;      width: 100px;      margin: 0 40rpx;      display: flex;      justify-content: center;			.unit4_box_value {				font-size: 30rpx;				color: #52c8f1;			}			.unit4_box_key {				font-size: 26rpx;			}		}    .unit4_box_item1{      //font-size: 40rpx;      margin-bottom: 20rpx;      ////width: 150rpx;    }	}	.fixation {		position: -webkit-sticky;		position: sticky;		z-index: 999;		background-color: #E5E5E5;		padding-top: 10rpx;	}  .fypage{    margin:30rpx 0;    display: flex;    justify-content: center;    align-items: center;  }  /deep/.u-scroll-list__indicator.data-v-e2a26316{    margin-top: 0;  }  .msj{    margin-top: 200px;    display: flex;    flex-direction: column;    justify-content: center;    align-items: center;  }  .cardlist{    margin: 6px 10px;  }  .cardlistmore{    width: 90%;    margin: 6px 10px;display: inline-flex;    justify-content: space-between;  }</style>